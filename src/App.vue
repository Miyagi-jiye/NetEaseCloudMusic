<template>
  <van-config-provider :theme="theme">
    <RouterView />
  </van-config-provider>
</template>

<script setup>
import { ref, provide, onMounted } from 'vue';
import { showConfirmDialog } from 'vant';

// è‡ªå®šä¹‰api
let api = ref()

//ä¸»é¢˜åˆ‡æ¢
const theme = ref('light')
provide('theme', theme)

onMounted(() => {
  // // // åˆ¤æ–­ç½‘ç»œåè®®ï¼Œå¦‚æœæ˜¯httpsåˆ™ä½¿ç”¨http
  // if (window.location.protocol === 'https:') {
  //   showConfirmDialog({
  //     title: 'æ³¨æ„ï¼ï¼',
  //     message: `
  //     è¯¥demoä½¿ç”¨<span style="color:red">http</span>åè®®è¿›è¡Œç½‘ç»œè¿æ¥
  //     æ£€æµ‹åˆ°æ‚¨å½“å‰ç½‘ç»œåè®®ä¸º<span style="color:red">https</span>
  //     æ˜¯å¦ç«‹å³åˆ‡æ¢ï¼Ÿ

  //     ğŸ˜€å¦‚æœåˆ‡æ¢å¤±è´¥è¯·è‡ªè¡Œç™¾åº¦æµè§ˆå™¨è®¾ç½®
  //     `,
  //     allowHtml: true,
  //   })
  //     .then(() => {
  //       // on confirm ç¡®è®¤åˆ‡æ¢ç½‘ç»œåè®®
  //       window.location.href = window.location.href.replace('https', 'http')//å¼ºåˆ¶ä½¿ç”¨httpåè®®
  //     })
  //     .catch(() => {
  //       // on cancel å–æ¶ˆåˆ‡æ¢ç½‘ç»œåè®®
  //       console.log(
  //         `å½“å‰ç½‘ç»œåè®®ä¸ºï¼š==>%c${window.location.protocol}`,
  //         'color: #fff;background: #000;padding: 2px 8px;border-radius: 5px;',
  //         '<==è¯·åˆ‡æ¢åˆ°httpåè®®'
  //       )
  //     });
  // } else {
  //   console.log(
  //     `%cå½“å‰ç½‘ç»œåè®®ä¸º%c|%c${window.location.protocol}%c|%c${new Date().toLocaleString()}`,
  //     'color: #08d9d6;background: #000;padding: 4px 0 4px 8px;border-radius:4px 0 0 4px;font-weight:bold;',
  //     'color: #eaeaea;background: #000;padding: 4px 4px; font-weight: bold;',
  //     'color: #ff2e63;background: #000;padding: 4px 0;font-weight: bold;',
  //     'color: #eaeaea;background: #000;padding: 4px 4px; font-weight: bold;',
  //     'color: #f9ed69;background: #000;padding: 4px 8px 4px 0;border-radius:0 4px 4px 0; font-weight: bold;',
  //   )
  // }

  // å‘é€è¯·æ±‚å‰åˆ¤æ–­æ˜¯å¦æœ‰è‡ªå®šä¹‰apiå¹¶ä¸”ä¸ä¸ºnullæˆ–undefined
  if (localStorage.getItem('api') && localStorage.getItem('api') !== 'null' && localStorage.getItem('api') !== 'undefined') {
    console.log(
      `%cå½“å‰ä½¿ç”¨çš„apiä¸º%c|%c${localStorage.getItem('api')}`,
      'color: #000000;background: #eaeaea;padding: 4px 0 4px 8px;border-radius:4px 0 0 4px;font-weight:bold;border: 1px solid #ff0000;border-width: 1px 0 1px 1px;',
      'color: #f00000;background: #eaeaea;padding: 4px 4px; font-weight: bold;border: 1px solid #ff0000;border-width: 1px 0 1px 0;',
      'color: #000000;background: #eaeaea;padding: 4px 8px 4px 0;border-radius:0 4px 4px 0; font-weight: bold;border: 1px solid #ff0000;border-width: 1px 1px 1px 0;',
    )
    return
  } else {
    // è¯·è¾“å…¥æ‚¨çš„ç½‘æ˜“äº‘æ¥å£åœ°å€
    api.value = prompt('è¯·è¾“å…¥æ‚¨çš„ç½‘æ˜“äº‘æ¥å£åœ°å€ï¼Œæ²¡æœ‰å¯ä½¿ç”¨æˆ‘æä¾›çš„é»˜è®¤æ¥å£', 'https://www.guowei.fun')
    // å­˜å…¥localStorage
    localStorage.setItem('api', api.value)
  }
})
</script>

<style scoped>
.van-theme-dark body {
  color: #f5f5f5;
  background-color: black;
}
</style>