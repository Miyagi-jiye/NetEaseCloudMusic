import{I as a,f as e,D as s,i as t,j as l,k as n,s as r}from"../vant/vant.52bb3d0f.js";import{P as u,Q as i,L as o,a0 as d,W as p,X as c,I as m,J as v,Z as g,R as w,U as _,V as f,r as h,a as y,G as k,O as b,_ as x,$ as D,S as C}from"../@vue/@vue.94aa2a2d.js";import{_ as V}from"../../assets/index-047f360a.js";import{a as j}from"../axios/axios.c5318529.js";import"../@vant/@vant.4990c6ed.js";import"../pinia/pinia.86e899a9.js";import"../vue-router/vue-router.b68e67a8.js";import"../nprogress/nprogress.6d8e6ba3.js";import"../form-data/form-data.01cb563f.js";import"../pinia-plugin-persistedstate/pinia-plugin-persistedstate.712c107f.js";const B={class:"bangumi-card"},P=["onClick"],F=["src"],A={class:"desc"},$=V({__name:"card",props:{data:{type:Array,default:()=>[]}},setup:a=>(e,s)=>(u(),i("div",B,[(u(!0),i(o,null,d(a.data,(a=>(u(),i("div",{class:"card-item",key:a.season_id,onClick:e=>{return s=a.url,void window.open(s);var s}},[p("img",{src:a.cover+"@240w_320h.webp",alt:"",referrerpolicy:"no-referrer"},null,8,F),p("div",A,[p("span",null,c(a.title),1),p("span",null,c(a.new_ep.index_show),1)])],8,P)))),128))]))},[["__scopeId","data-v-fe538bd4"]]),R={class:"bangumi-list"},E={class:"cover-and-title"},I=["src"],M={class:"right"},U={class:"title"},z={class:"desc"},L={class:"type-and-area"},S={key:0},H={key:2},K={class:"score-and-tags"},N={key:0,class:"score"},T={key:1,class:"no-score"},Y={class:"tags"},G={class:"tag"},J={class:"stat"},O={key:0,class:"update-ep"},Q=["onClick"],W=V({__name:"list",props:{data:{type:Array,default:()=>[]}},setup(a){const e=a=>a>1e4?(a/1e4).toFixed(0)+"万":a,s=a=>{const e=new Date(a).getTime()+new Date(6048e5).getTime(),s=(new Date).getFullYear(),t=(new Date).getMonth()+1,l=(new Date).getDate(),n=new Date(e).getFullYear(),r=new Date(e).getMonth()+1,u=new Date(e).getDate();return s===n&&t===r&&l===u},t=a=>{if(null===a||""===a)return"敬请期待";const e=["日","一","二","三","四","五","六"],t=new Date(a),l=t.getDay(),n=t.getHours(),r=t.getMinutes(),u=n<10?"0"+n:n,i=r<10?"0"+r:r;return s(a)?`今天${u}:${i}更新`:`每周${e[l]}${u}:${i}更新`},l=(a,e)=>"全片"==e||"正片"==e&&1==a||a==Number(e),n=(a,e)=>"全片"==a||"正片"==a||e<=Number(a),r=a=>{const e=[];for(let s=0;s<a;s++)e.push(s+1);return e};return(_,f)=>(u(),i("ul",R,[(u(!0),i(o,null,d(a.data,(a=>(u(),i("li",{class:"list-item",key:a.season_id},[p("div",E,[p("img",{class:"left",src:a.cover+"@240w_320h.webp",alt:"",referrerpolicy:"no-referrer"},null,8,I),p("div",M,[p("span",U,c(a.title),1),p("span",z,c(a.summary),1),p("span",L,[p("span",null,c(a.season_type_name),1),(u(!0),i(o,null,d(a.areas,(a=>(u(),i("span",null,c(a.name),1)))),256)),m(p("span",null,"全"+c(a.total_count)+"话",513),[[v,0==l(a.total_count,a.new_ep.title)]]),m(p("span",null,"已完结",512),[[v,1==l(a.total_count,a.new_ep.title)]]),a.new_ep.index_show?(u(),i("span",S,c(a.new_ep.index_show),1)):g("",!0),a.new_ep.pub_time?(u(),i("span",{key:1,class:w(1==s(a.new_ep.pub_time)?"todayActive":"")},c(t(a.new_ep.pub_time)),3)):(u(),i("span",H,"敬请期待"))]),p("div",K,[a.rating?(u(),i("span",N,c(a.rating.score),1)):(u(),i("span",T,"暂无评分")),p("span",Y,[(u(!0),i(o,null,d(a.styles,(a=>(u(),i("span",G,c(a),1)))),256))])]),p("div",J,[p("span",null,c(e(a.stat.view))+"播放",1),p("span",null,c(e(a.stat.follow))+"追番",1),p("span",null,c(e(a.stat.danmaku))+"弹幕",1)])])]),a.total_count>=0?(u(),i("ul",O,[(u(!0),i(o,null,d(r(a.total_count),(e=>(u(),i("li",{class:w(["ep",n(a.new_ep.title,e)?"epActive":""]),onClick:e=>{return s=a.url,void window.open(s);var s}},c(e),11,Q)))),256))])):g("",!0)])))),128))]))}},[["__scopeId","data-v-5c3f043a"]]),X={},Z=a=>(_("data-v-1a4037aa"),a=a(),f(),a),q={class:"button"},aa=[Z((()=>p("div",{class:"icon"},[p("svg",{t:"1670508414944",class:"bi bi-telegram",viewBox:"0 0 1129 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2699",fill:"currentColor",height:"16",width:"16"},[p("path",{d:"M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75h-738.7a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0",fill:"#20B0E3","p-id":"2700"}),p("path",{d:"M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0",fill:"#20B0E3","p-id":"2701"})])],-1))),Z((()=>p("p",null,"查看",-1)))];const ea=V(X,[["render",function(a,e){return u(),i("button",q,aa)}],["__scopeId","data-v-1a4037aa"]]);const sa={class:"bilibili"},ta={class:"search"},la={class:"top"},na={class:"content"},ra={class:"user"},ua={class:"left"},ia=["src","alt"],oa={class:"center"},da={class:"name"},pa={class:"desc"},ca={class:"right"},ma=V({__name:"index",setup(g){const w=h(0),_=[{text:"默认排序",value:0},{text:"粉丝数排序",value:1},{text:"等级排序",value:2}],f=h("card"),V=[{text:"列表布局",value:"list"},{text:"卡片布局",value:"card"}],B=h(!1),P=h(null),F=h(!1),A=h(!1),R=y({userParams:{keyword:"",page:1,limit:10},params:{type:1,follow_status:0,pn:1,ps:20,vmid:24772083,ts:Date.now()},list:[],total:0,result:[],numPages:0,numResults:0}),E=async()=>{const a=await function({type:a=1,follow_status:e=0,pn:s=1,ps:t=20,vmid:l=24772083,ts:n=Date.now()}){return j({url:"http://guowei.fun:9999/api/bangumi",method:"get",params:{type:a,follow_status:e,pn:s,ps:t,vmid:l,ts:n}})}(R.params);return a.data&&a.data.list&&a.data.list.length>0?(1===R.params.pn?(R.total=a.data.total,R.list=a.data.list,console.log("首次数据获取成功",a.data.list)):(R.list=[...new Set([...R.list,...a.data.list])],console.log("第",R.params.pn,"页",a.data.list)),!0):(n({title:"抱歉",message:"该用户未开放追番查看权限"}),B.value=!1,!1)},I=async()=>{const a=await function({keyword:a,page:e=1,limit:s=20}){return j({url:"http://guowei.fun:9999/api/search",method:"get",params:{keyword:a,page:e,limit:s}})}(R.userParams);if(!a.data||!a.data.result)return r({type:"danger",message:"用户不存在"}),B.value=!1,!1;1===R.userParams.page?(R.result=a.data.result,R.numPages=a.data.numPages,R.numResults=a.data.numResults,console.log("用户信息",a.data)):(R.result=[...new Set([...R.result,...a.data.result])],console.log("第",R.userParams.page,"页",a.data.result))},M=()=>{null!==P.value&&""!==P.value&&(B.value=!1,R.userParams.keyword=P.value,R.userParams.page=1,R.params.pn=1,F.value=!1,A.value=!1,R.result=[],R.list=[],I())},U=async a=>{"bangumi"===a&&0!==R.list.length?(R.params.pn++,await E(),F.value=!1,0!==R.total&&R.list.length>=R.total&&(A.value=!0),console.log(R.list.length,R.total)):"user"===a&&0!==R.result.length?(R.userParams.page++,await I(),F.value=!1,0!==R.numResults&&R.result.length>=R.numResults&&(A.value=!0),console.log(R.result.length,R.numResults)):F.value=!1};return(n,r)=>{const g=a,h=e,y=s,j=t,I=l;return u(),i("div",sa,[p("div",ta,[p("div",la,[k(g,{name:"arrow-left",size:"22",onClick:r[0]||(r[0]=a=>n.$router.back())}),k(h,{modelValue:P.value,"onUpdate:modelValue":r[1]||(r[1]=a=>P.value=a),placeholder:"请输入B站用户名","input-align":"center",shape:"round",clearable:!1,onKeydown:b(x(M,["stop"]),["enter"])},null,8,["modelValue","onKeydown"]),p("span",{class:"searchBtn",onClick:M},"搜索")]),k(j,null,{default:D((()=>[k(y,{modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=a=>w.value=a),options:_},null,8,["modelValue"]),k(y,{modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=a=>f.value=a),options:V},null,8,["modelValue"])])),_:1})]),m(p("div",na,[k(I,{loading:F.value,"onUpdate:loading":r[4]||(r[4]=a=>F.value=a),finished:A.value,"finished-text":"没有更多了",onLoad:r[5]||(r[5]=a=>U("bangumi"))},{default:D((()=>[m(k(W,{data:R.list},null,8,["data"]),[[v,"list"==f.value]]),m(k($,{data:R.list},null,8,["data"]),[[v,"card"==f.value]])])),_:1},8,["loading","finished"])],512),[[v,1==B.value]]),m(p("div",ra,[k(I,{loading:F.value,"onUpdate:loading":r[6]||(r[6]=a=>F.value=a),finished:A.value,"finished-text":"没有更多了",onLoad:r[7]||(r[7]=a=>U("user"))},{default:D((()=>[(u(!0),i(o,null,d(R.result,(a=>{return u(),i("div",{class:"user__item",key:a.mid},[p("div",ua,[p("img",{src:`https:${a.upic}@50w_50h.webp`,alt:a.uname,referrerpolicy:"no-referrer"},null,8,ia)]),p("div",oa,[p("div",da,[p("span",null,c(a.uname),1),p("span",{class:"level",style:C({backgroundColor:(e=a.level,0==e||1==e?"#C0C0C0":2==e?"#8BD29B":3==e?"#7BCDEF":4==e?"#FEBB8B":5==e?"#EE672A":6==e?"#FF0000":"#F152F0")})}," LV"+c(a.level),5)]),p("span",pa,c(a.usign),1)]),p("div",ca,[k(ea,{onClick:e=>(async a=>{R.params.vmid=a,await E()&&(B.value=!0)})(a.mid)},null,8,["onClick"])])]);var e})),128))])),_:1},8,["loading","finished"])],512),[[v,0==B.value]])])}}},[["__scopeId","data-v-50c27415"]]);export{ma as default};
