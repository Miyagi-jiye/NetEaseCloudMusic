import{I as e,F as a,r as s,t,e as o,u as n,s as l}from"../vant/vant.52bb3d0f.js";import{u as i}from"../vue-router/vue-router.b68e67a8.js";import{s as u}from"../pinia/pinia.86e899a9.js";import{u as p}from"../index/index.7b9efb6e.js";import{_ as r}from"../../assets/index-047f360a.js";import{r as d,P as m,Q as c,W as f,G as g,$ as v,u as h,a2 as b,M as y,U as j,V as _}from"../@vue/@vue.94aa2a2d.js";import"../@vant/@vant.4990c6ed.js";import"../axios/axios.c5318529.js";import"../form-data/form-data.01cb563f.js";import"../nprogress/nprogress.6d8e6ba3.js";import"../pinia-plugin-persistedstate/pinia-plugin-persistedstate.712c107f.js";const x=e=>(j("data-v-4be74882"),e=e(),_(),e),k={class:"phone"},V=x((()=>f("span",null,"手机号登录",-1))),C={class:"content"},w=x((()=>f("div",{class:"desc"},[f("span",null,"登录体验更多精彩"),f("span",null,"未注册手机号验证后自动创建账号")],-1))),F={key:1},L={style:{padding:"16px"}},U=r({__name:"index",setup(r){const j=d(!1),_=d(6e4),x=i(),{isLogin:U}=u(p()),{captchaLogin:q,getSendCaptcha:z,getLoginByCaptcha:I}=p();async function S(){console.log("表单验证通过");const e=await I();200==e.code?(l({type:"success",message:"登录成功"}),U.value=!0,q.phone="",q.captcha="",x.push({path:"/home"})):(q.captcha="",l({type:"danger",message:e.msg??e.message??"登录失败"}))}async function $(){if(11!==q.phone.length)return void l({type:"danger",message:"请输入正确的手机号"});const e=await z();200===e.code?(j.value=!0,_.value=6e4,l({type:"success",message:"验证码发送成功"})):(j.value=!1,l({message:e.message??"获取验证码失败",color:"#ffffff",background:"#F9343D",position:"top",duration:2e3}))}function B(){j.value=!1}return(l,i)=>{const u=e,p=a,r=s,d=t,x=o,U=n;return m(),c("div",k,[f("div",{class:"top",onClick:i[0]||(i[0]=e=>l.$router.back())},[g(u,{name:"arrow-left",size:"23"}),V]),f("div",C,[w,g(U,{onSubmit:S},{default:v((()=>[g(x,null,{default:v((()=>[g(p,{modelValue:h(q).phone,"onUpdate:modelValue":i[1]||(i[1]=e=>h(q).phone=e),label:"手机号",placeholder:"请输入手机号",type:"number",rules:[{required:!0,message:"请输入手机号"}]},null,8,["modelValue"]),g(p,{modelValue:h(q).captcha,"onUpdate:modelValue":i[2]||(i[2]=e=>h(q).captcha=e),label:"验证码",placeholder:"请输入手机验证码",type:"number",rules:[{required:!0,message:"请输入手机验证码"}]},{button:v((()=>[g(d,{size:"small",type:"default",onClick:$,disabled:j.value},{default:v((()=>[1==j.value?(m(),b(r,{key:0,time:_.value,format:"ss 秒",onFinish:B},null,8,["time"])):(m(),c("span",F,"获取验证码"))])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1}),f("div",L,[g(d,{type:"danger",round:"",block:"","native-type":"submit"},{default:v((()=>[y("登录")])),_:1})])])),_:1})])])}}},[["__scopeId","data-v-4be74882"]]);export{U as default};
