function e(e,r){var t;return e="object"==typeof(t=e)&&null!==t?e:Object.create(null),new Proxy(e,{get:(e,t,o)=>"key"===t?Reflect.get(e,t,o):Reflect.get(e,t,o)||Reflect.get(r,t,o)})}function r(e,{storage:r,serializer:t,key:o,debug:s}){try{const s=null==r?void 0:r.getItem(o);s&&e.$patch(null==t?void 0:t.deserialize(s))}catch(n){s&&console.error(n)}}function t(e,{storage:r,serializer:t,key:o,paths:s,debug:n}){try{const n=Array.isArray(s)?function(e,r){return r.reduce(((r,t)=>{const o=t.split(".");return function(e,r,t){return r.slice(0,-1).reduce(((e,r)=>/^(__proto__)$/.test(r)?{}:e[r]=e[r]||{}),e)[r[r.length-1]]=t,e}(r,o,function(e,r){return r.reduce(((e,r)=>null==e?void 0:e[r]),e)}(e,o))}),{})}(e,s):e;r.setItem(o,t.serialize(n))}catch(l){n&&console.error(l)}}var o=function(o={}){return s=>{const{options:{persist:n},store:l}=s;if(!n)return;const a=(Array.isArray(n)?n.map((r=>e(r,o))):[e(n,o)]).map((({storage:e=localStorage,beforeRestore:r=null,afterRestore:t=null,serializer:s={serialize:JSON.stringify,deserialize:JSON.parse},key:n=l.$id,paths:a=null,debug:i=!1})=>{var c;return{storage:e,beforeRestore:r,afterRestore:t,serializer:s,key:(null!=(c=o.key)?c:e=>e)(n),paths:a,debug:i}}));a.forEach((e=>{const{beforeRestore:o,afterRestore:n}=e;null==o||o(s),r(l,e),null==n||n(s),l.$subscribe(((r,o)=>{t(o,e)}),{detached:!0})})),l.$persist=()=>{a.forEach((e=>{t(l.$state,e)}))},l.$hydrate=({runHooks:e=!0}={})=>{a.forEach((t=>{const{beforeRestore:o,afterRestore:n}=t;e&&(null==o||o(s)),r(l,t),e&&(null==n||n(s))}))}}}();export{o as s};
